#+TITLE: My StumpWM configuration
#+AUTHOR: Johannes Maier
#+EMAIL: johannes.maier@mailbox.org
#+STARTUP: showall

* StumpWM configuration

#+begin_src common-lisp
(in-package :stumpwm)
#+end_src

Load and start a slynk server in a background thread.  At a later
date, this should be made into a command in order to only start it
whenever I want to connect to StumpWM via SLY REPL.

#+begin_src common-lisp
(ql:quickload :slynk)

(defcommand my/start-slynk-server (port)
    ((:number "Enter the port [default = 4444]: "))
  (let ((actual-port (or port 4444)))
    (sb-thread:make-thread
     (lambda ()
       (slynk:create-server
        :port actual-port
        :dont-close t))
     :name "slynk-auto")
    (message "Slynk server running on port ~a" actual-port)))
#+end_src

#+begin_src common-lisp
(load-module "ttf-fonts")
(setq clx-truetype::*font-dirs*
      (append (list (namestring "~/.nix-profile/share/fonts")
                    (namestring "~/.nix-profile/share/fonts/truetype")
                    (namestring "~/.nix-profile/share/fonts/opentype"))
              clx-truetype::*font-dirs*))
(when (not (find "JetBrains Mono Regular" (xft:get-font-families)
                 :test #'equal))
  (xft:cache-fonts))

(set-font (make-instance 'xft:font
                         :family "JetBrains Mono"
                         :subfamily "Regular"
                         :size 20
                         :antialias t))

(setf *message-window-gravity* :center
      ,*message-window-padding* 5)
(setf *input-window-gravity* :center)
#+end_src

The default repeat rate of keys is way too low for my taste, so I
usually increase it.  In StumpWM, those things are just executed in a
shell:

#+begin_src common-lisp
(run-shell-command "xset r rate 200 55")
#+end_src

;; Local Variables:
;; eval: (add-hook 'after-save-hook
;;                 (lambda () 
;;                   (org-babel-tangle nil "init.lisp"))
;;                 nil t)
;; End:
